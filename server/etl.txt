

/////////import to temp file
COPY reviews_temp FROM '/Users/mattwaelder/hackreactor/rfp2207-sdc/csv_files/reviews.csv' DELIMITER ',' CSV HEADER;

/////////////////////////////////////////////////////////////////////
INSERT INTO reviews SELECT
id, product_id, rating,
to_timestamp(cast(created_at/1000 as bigint))::date,
summary, body, recommend, reported, reviewer_name, reviewer_email, response, helpfulness
FROM reviews_temp;
/////////////////////////////////////////////////////////////////////

//import photos
COPY review_photos FROM '/Users/mattwaelder/hackreactor/rfp2207-sdc/csv_files/reviews_photos.csv' DELIMITER ',' CSV HEADER;

//import characteristics
COPY characteristics FROM '/Users/mattwaelder/hackreactor/rfp2207-sdc/csv_files/characteristic_reviews.csv' DELIMITER ',' CSV HEADER;


//////////

INSERT INTO reviews
  SELECT "date" from reviews_temp

to_timestamp(1284352323) â†’ 2010-09-13 04:32:03+00
CAST(expression as datatype)
CAST expression::datatype

INSERT INTO reviews("date") select to_timestamp(cast(date/1000 as bigint))::date from reviews_temp;

//////////

COPY reviews FROM '/Users/mattwaelder/hackreactor/rfp2207-sdc/csv_files/reviews.csv' DELIMITER ',' CSV HEADER;

COPY reviews_meta FROM '/Users/mattwaelder/hackreactor/rfp2207-sdc/csv_files/characteristic_reviews.csv' DELIMITER ',' CSV HEADER;

need to make staging table (what i have) and production table (with better date)
copy from staging to production with
INSERT INTO production
  SELECT (date transformed) FROM staging